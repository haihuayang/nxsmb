
#include "../src/smb2.hxx"


static void test_lz77_decompress()
{
	const uint8_t in_data[] = {
		0xc0, 0x82, 0xad, 0x00, 0xfe, 0x53, 0x4d, 0x42,
		0x40, 0x00, 0x01, 0x00, 0x01, 0x00, 0x09, 0x38,
		0x00, 0x08, 0x38, 0x00, 0x01, 0x00, 0x04, 0x18,
		0x00, 0x01, 0x00, 0xff, 0xfe, 0x00, 0x00, 0x05,
		0xb8, 0x00, 0x05, 0x58, 0x00, 0x29, 0x01, 0xdd,
		0x2c, 0x23, 0xa8, 0x89, 0xdc, 0xc7, 0x84, 0x01,
		0x00, 0x86, 0xbf, 0x0a, 0xb3, 0xe1, 0xff, 0x7a,
		0xe5, 0xc3, 0x4c, 0x31, 0x00, 0x70, 0x00, 0x2c,
		0xc1, 0x00, 0x04, 0x00, 0xfe, 0xff, 0xff, 0xff,
		0x30, 0x00, 0x00, 0x05, 0x45, 0x02, 0x07, 0x00,
		0xf5, 0x61, 0x62, 0x63, 0x17, 0x00, 0xff, 0x26,
		0x01,
	};

	uint8_t out_data[412];

	int ret = x_smb2_decompress(X_SMB2_COMPRESSION_LZ77,
			in_data, sizeof in_data,
			out_data, sizeof out_data);
	X_ASSERT(ret == sizeof out_data);
}

int main()
{
	test_lz77_decompress();
	return 0;
}
