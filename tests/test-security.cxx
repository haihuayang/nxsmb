
#include <assert.h>
#include <cstring>
#include "librpc/idl/security.h"
#include "common.h"

static const uint8_t acl_data[] = {
	0x01, 0x00, 0x04, 0x84, 0x14, 0x00, 0x00, 0x00,
	0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x4c, 0x00, 0x00, 0x00, 0x01, 0x05, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x05, 0x15, 0x00, 0x00, 0x00,
	0x60, 0x76, 0xcb, 0x9c, 0x8f, 0xfe, 0x77, 0xf7,
	0xa7, 0xed, 0x55, 0x10, 0xf4, 0x01, 0x00, 0x00,
	0x01, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05,
	0x15, 0x00, 0x00, 0x00, 0x60, 0x76, 0xcb, 0x9c,
	0x8f, 0xfe, 0x77, 0xf7, 0xa7, 0xed, 0x55, 0x10,
	0x01, 0x02, 0x00, 0x00, 0x02, 0x00, 0x10, 0x01,
	0x08, 0x00, 0x00, 0x00, 0x01, 0x00, 0x24, 0x00,
	0xa9, 0x00, 0x02, 0x00, 0x01, 0x05, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x05, 0x15, 0x00, 0x00, 0x00,
	0x60, 0x76, 0xcb, 0x9c, 0x8f, 0xfe, 0x77, 0xf7,
	0xa7, 0xed, 0x55, 0x10, 0x60, 0x04, 0x00, 0x00,
	0x00, 0x00, 0x24, 0x00, 0xa9, 0x00, 0x12, 0x00,
	0x01, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05,
	0x15, 0x00, 0x00, 0x00, 0x60, 0x76, 0xcb, 0x9c,
	0x8f, 0xfe, 0x77, 0xf7, 0xa7, 0xed, 0x55, 0x10,
	0x88, 0x04, 0x00, 0x00, 0x01, 0x10, 0x24, 0x00,
	0xa9, 0x00, 0x02, 0x00, 0x01, 0x05, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x05, 0x15, 0x00, 0x00, 0x00,
	0x60, 0x76, 0xcb, 0x9c, 0x8f, 0xfe, 0x77, 0xf7,
	0xa7, 0xed, 0x55, 0x10, 0x61, 0x04, 0x00, 0x00,
	0x00, 0x10, 0x24, 0x00, 0xa9, 0x00, 0x12, 0x00,
	0x01, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05,
	0x15, 0x00, 0x00, 0x00, 0x60, 0x76, 0xcb, 0x9c,
	0x8f, 0xfe, 0x77, 0xf7, 0xa7, 0xed, 0x55, 0x10,
	0x89, 0x04, 0x00, 0x00, 0x01, 0x10, 0x24, 0x00,
	0xa9, 0x00, 0x02, 0x00, 0x01, 0x05, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x05, 0x15, 0x00, 0x00, 0x00,
	0x60, 0x76, 0xcb, 0x9c, 0x8f, 0xfe, 0x77, 0xf7,
	0xa7, 0xed, 0x55, 0x10, 0x8b, 0x04, 0x00, 0x00,
	0x00, 0x10, 0x24, 0x00, 0xff, 0x01, 0x1f, 0x00,
	0x01, 0x05, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05,
	0x15, 0x00, 0x00, 0x00, 0x60, 0x76, 0xcb, 0x9c,
	0x8f, 0xfe, 0x77, 0xf7, 0xa7, 0xed, 0x55, 0x10,
	0xf4, 0x01, 0x00, 0x00, 0x00, 0x10, 0x18, 0x00,
	0xff, 0x01, 0x1f, 0x00, 0x01, 0x02, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x05, 0x20, 0x00, 0x00, 0x00,
	0x20, 0x02, 0x00, 0x00, 0x00, 0x10, 0x18, 0x00,
	0xff, 0x01, 0x1f, 0x00, 0x01, 0x02, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x05, 0x20, 0x00, 0x00, 0x00,
	0x21, 0x02, 0x00, 0x00, 
};

static void test_security()
{
	verify<idl::security_descriptor>(acl_data, sizeof acl_data, true);
}

int main(int argc, char  **argv)
{
	test_security();
	return 0;
}

